scale_fill_discrete(name = "Compra", labels = c("No", "Si")) + theme_bw()
ggplot(datos,aes(x=rating,y=budget/1000000, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Género", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por género")+
scale_fill_discrete(name = "Compra", labels = c("No", "Si")) + theme_bw()
ggplot(datos,aes(x=rating,y=gross/1000000, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
scale_fill_discrete(name = "Compra", labels = c("No", "Si")) + theme_bw()
datos$gross
ggplot(datos,aes(x=rating,y=gross, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
scale_fill_discrete(name = "Compra", labels = c("No", "Si")) + theme_bw()
ggplot(datos,aes(x=rating,y=gross/1000000, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
scale_fill_discrete(name = "Compra", labels = c("No", "Si")) + theme_bw()
#graficamos la ganancia contra el genero
ggplot(datos,aes(x=genre,y=gross/1000000, color=genre)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Género", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por género")+
scale_fill_discrete(name = "Compra", labels = c("No", "Si")) + theme_bw()
datos %>%
ggplot(aes(x = rating, fill = rating))+
geom_bar()
ggplot(datos,aes(x=rating,y=gross/1000000, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
scale_fill_discrete(name = "Compra", labels = c("No", "Si")) + theme_bw()
ggplot(datos,aes(x=rating,y=gross/1000000, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
theme_bw()
max(datos$gross)
View(datos)
datos=read.csv('Data/movies.csv')
#Ahora realizamos los histogramas respectivos
hist(datos$budget/1000000,  main="Presupuestos")
hist(datos$gross, main="Dinero recaudado por película")
hist(datos$runtime, main="Duración por película")
hist(datos$score, main="Puntuación de la película")
hist(datos$votes, main="Cantidad de votantes por película")
hist(datos$year, main="Años de lanzamiento por película")
#Group by es uno de los comandos más útiles que tiene el paquete dplyr. Como su nombre lo dice nos permite agrupar variables
#y hacer cálculos entre los grupos, por ejemplo calcular nuevas variables o estadísticos para los grupos.
datos %>%
group_by(datos$country) %>%
summarise(TNprom = mean(datos$gross))
datos %>%
group_by(datos$country) %>%
summarise(TNprom = mean(datos$score))
#Ahora vemos la matriz de correlaciones entre las variables numéricas
cor(datos_num)
#Tambien podemos ver la matriz de correlaciones graficamente
crr = round(cor(datos_num),2)
corrplot(crr,method="number",type="upper")
par(mfrow=c(2,2), bg="azure")
barplot(loadings(pca.datos_num)[,1],col="blue2",sub="Primera componente")
barplot(loadings(pca.datos_num)[,2],col="orange",sub="Segunda componente")
barplot(loadings(pca.datos_num)[,3],col="blue2",sub="tercera componente")
barplot(loadings(pca.datos_num)[,4],col="orange",sub="cuarta componente")
barplot(loadings(pca.datos_num)[,4],col="blue2",sub="quinta componente")
#Ahora realizamos los histogramas respectivos
hist(datos$budget/1000000,  main="Presupuestos")
hist(datos$gross, main="Dinero recaudado por película")
hist(datos$runtime, main="Duración por película")
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram()
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram()+density()
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram()+density(x = runtime)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_bar()
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 20)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 30)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 1)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 10)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(250)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(0,250)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") + ylab("Número de producciones")
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") + ylab("Número de producciones") +geom_density(color="red")
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") + ylab("Número de producciones") +geom_density(runtime,color="red")
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") + ylab("Número de producciones") +geom_density(col="red")
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") + ylab("Número de producciones") +geom_density(aes(x = runtime), col = "red")
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") + ylab("Número de producciones")
hist(datos$score, main="Puntuación de la película")
#Analisis variable score
datos %>%
ggplot(aes(x = score)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Score") + ylab("Número de producciones")
#Analisis variable score
datos %>%
ggplot(aes(x = score)) +
geom_histogram(binwidth = 8)+
xlab("Score") + ylab("Número de producciones")
#Analisis variable score
datos %>%
ggplot(aes(x = score)) +
geom_bar(binwidth = 8)+
xlab("Score") + ylab("Número de producciones")
#Analisis variable score
datos %>%
ggplot(aes(x = score)) +
geom_bar())+
xlab("Score") + ylab("Número de producciones")
#Analisis variable score
datos %>%
ggplot(aes(x = score)) +
geom_bar()+
xlab("Score") + ylab("Número de producciones")
View(datos)
ggplot(datos,aes(x=rating,y=score, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
theme_bw()
ggplot(datos,aes(x=rating,y=score, color=genre)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
theme_bw()
ggplot(datos,aes(x=rating,y=genre, color=genre)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
theme_bw()
ggplot(datos,aes(x=rating,y=score, color=genre)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
theme_bw()
ggplot(datos,aes(x=rating,y=score, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
theme_bw()
datos %>%
ggplot(aes(x = votes)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") + ylab("Número de producciones")
datos %>%
ggplot(aes(x = votes)) +
geom_bar()+
xlab("Score") + ylab("Número de producciones")
str(datos)
datos %>%
ggplot(aes(x = votes)) +
geom_bar()+
xlab("Score") + ylab("Número de producciones")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram()+
xlab("Score") + ylab("Número de producciones")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram(binwidth = 10)+
xlab("Score") + ylab("Número de producciones")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram(binwidth = 20)+
xlab("Score") + ylab("Número de producciones")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram(binwidth = 30)+
xlab("Score") + ylab("Número de producciones")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram()+
xlab("Score") + ylab("Número de producciones")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram(binwidth = 10)+
xlab("Score") + ylab("Número de Votos")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram(binwidth = 10)+
xlab("Votos") + ylab("Número de Votos")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram(binwidth = 10)+
xlab("Votos") + ylab("Número de Votos")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram(binwidth = 10)+
xlab("Votos") + ylab("Número de Votos")
datos %>%
ggplot(aes(x = votes)) +
geom_histogram()+
xlab("Votos") + ylab("Número de Votos")
datos %>%
ggplot(aes(x = votes/1000)) +
geom_histogram()+
xlab("Votos") + ylab("Número de Votos")
datos
str(datos)
datos=read.csv('Data/movies.csv')
datos <- datos %>%
select(budget,country,genre,gross,rating,runtime,score,votes,year)
str(datos)
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8,9), title = "MT Cars",
mapping=ggplot2::aes(colour = gear), axisLabels = "show")
library(GGally)
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8,9), title = "MT Cars",
mapping=ggplot2::aes(colour = gear), axisLabels = "show")
sm
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8,9), title = "MT Cars",
mapping=ggplot2::aes(colour = rating), axisLabels = "show")
sm
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "MT Cars",
mapping=ggplot2::aes(colour = rating), axisLabels = "show")
sm
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "MT Cars",
mapping=ggplot2::aes(colour = rating,alpha = 0.5), axisLabels = "show")
sm
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "Correlación entre variables numéricas",
mapping=ggplot2::aes(colour = rating,alpha = 0.5), axisLabels = "show")
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "Correlación entre variables numéricas",
mapping=ggplot2::aes(colour = rating,alpha = 0.3), axisLabels = "show")
sm
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "Correlación entre variables numéricas",
mapping=ggplot2::aes(colour = rating,alpha = 1), axisLabels = "show")
sm
datos=read.csv('Data/movies.csv')
rownames(datos) <- datos$name
datos <- datos %>%
select(budget,country,genre,gross,rating,runtime,score,votes,year)
head(datos)
datos1=read.csv('Data/movies.csv')
datos <- datos1 %>%
select(budget,country,genre,gross,rating,runtime,score,votes,year)
rownames(datos1) <- datos$name
head(datos)
str(datos)
datos1=read.csv('Data/movies.csv')
rownames(datos1) <- datos$name
datos <- datos1 %>%
select(budget,country,genre,gross,rating,runtime,score,votes,year)
str(datos)
head(datos)
attach(datos)
# Analizamos los paises
datos %>%
count(country != "USA")
df <- data.frame(
Country <- c("USA","Extranjera"),
num <- c(4652,1855)
)
ggplot( data = df,aes(x = Country, y = num, fill = Country)) +
geom_bar(stat = "identity")+
theme(legend.position = "none")+
ylab("Numero de Producciones")+
xlab("Procedencia de las producciones")
ggplot( data = df,aes(x = Country, y = num, fill = Country)) +
geom_bar(stat = "identity")+
theme(legend.position = "none")+
ylab("Numero de Producciones")+
xlab("Procedencia de las producciones")+
ggtitle("Número de producciones dentro y fuera de USA")
w = 6
h = 3
ggsave('Output/Images/1barplotpaises.eps', width = w, height = h)
ggsave('Output/Images/1barplotpaises.png', width = w, height = h)
# Vemos que USA lidera el numero de producciones por mucho frente a las
# Extranjeras
# Analizamos por genero
table(datos$genre)
ggplot(datos, aes(x=genre, fill = genre))+
geom_bar()
ggplot(datos, aes(x=genre))+
geom_bar(show.legend = F)
w = 3
h = 6
data
ggplot( data = df,aes(x = Country, y = num, fill = Country)) +
geom_bar(stat = "identity")+
theme(legend.position = "none")+
ylab("Numero de Producciones")+
xlab("Procedencia de las producciones")+
ggtitle("Número de producciones dentro y fuera de USA")
ggsave('Output/Images/1barplotpaises.png', width = w, height = h)
ggsave('Output/Images/2barplotgenero.png', width = w, height = h)
w = 6
h = 6
ggplot( data = df,aes(x = Country, y = num, fill = Country)) +
geom_bar(stat = "identity")+
theme(legend.position = "none")+
ylab("Numero de Producciones")+
xlab("Procedencia de las producciones")+
ggtitle("Número de producciones dentro y fuera de USA")
ggsave('Output/Images/1barplotpaises.png', width = w, height = h)
ggplot(datos, aes(x=genre))+
geom_bar(show.legend = F)
ggsave('Output/Images/2barplotgenero.png', width = w, height = h)
ggplot(datos, aes(x=genre))+
geom_bar(show.legend = F)+
ggtitle("Número de producciones por género")+
xlab("Género")+ylab("Número de producciones")
ggsave('Output/Images/2barplotgenero.png', width = w, height = h)
ggplot(datos, aes(x=genre))+
geom_bar(show.legend = F)+
ggtitle("Número de producciones por género")+
xlab("Género")+ylab("Número de producciones")
ggsave('Output/Images/2barplotgenero.png', width = w+3, height = h)
#graficamos la ganancia contra el genero
ggplot(datos,aes(x=genre,y=gross/1000000, color=genre)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Género", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por género")+
scale_fill_discrete(name = "Compra", labels = c("No", "Si")) + theme_bw()
ggsave('Output/Images/3gananciasporgenero.png', width = w, height = h)
ggsave('Output/Images/3gananciasporgenero.png', width = w, height = h+2)
ggsave('Output/Images/3gananciasporgenero.png', width = w+2, height = h+2)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") + ylab("Número de producciones")
ggsave('Output/Images/3histduracion.png', width = w, height = h)
ggsave('Output/Images/4histduracion.png', width = w, height = h)
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") +
ylab("Número de producciones") +
ggtitle("Número de producciones por Duración")
# Analisis variable runtime
datos %>%
ggplot(aes(x = runtime)) +
geom_histogram(binwidth = 8)+
xlim(50,250) + xlab("Duración") +
ylab("Número de producciones") +
ggtitle("Número de producciones por Duración")
#Analisis variable score
datos %>%
ggplot(aes(x = score)) +
geom_bar()+
xlab("Score") + ylab("Número de producciones")
ggsave('Output/Images/5barplotscore.png', width = w, height = h)
#Analisis variable score
datos %>%
ggplot(aes(x = score)) +
geom_bar()+
xlab("Score") + ylab("Número de producciones") +
ggtitle("Número de producciones por Score")
ggsave('Output/Images/5barplotscore.png', width = w, height = h)
sm <- ggpairs(datos, columns = c(1,6,10), title = "MT Cars",
mapping=ggplot2::aes(colour = gear), axisLabels = "show")
str(datos)
sm <- ggpairs(datos, columns = c(budget,gross,runtime.score,votes), title = "MT Cars",
mapping=ggplot2::aes(colour = gear), axisLabels = "show")
sm <- ggpairs(datos, columns = c(budget,gross,runtime,score,votes), title = "MT Cars",
mapping=ggplot2::aes(colour = gear), axisLabels = "show")
str(datos)
sm <- ggpairs(datos, columns = c(1,4,5,6,7), title = "MT Cars",
mapping=ggplot2::aes(colour = gear), axisLabels = "show")
sm
sm <- ggpairs(datos, columns = c(1,4,5,6,7), title = "MT Cars",
axisLabels = "show")
sm
summary(datos)
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "MT Cars",
axisLabels = "show")
sm
sm <- ggpairs(datos, columns = c(1,4,5,6,7), title = "MT Cars",
mapping=ggplot2::aes(colour = rating, alpha = 1), axisLabels = "show")
sm
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "MT Cars",
mapping=ggplot2::aes(colour = rating, alpha = 1), axisLabels = "show")
sm
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "MT Cars",
mapping=ggplot2::aes(colour = rating, alpha = 1.4), axisLabels = "show")
sm
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "Correlación entre variables numéricas",
mapping=ggplot2::aes(colour = rating,alpha = 1), axisLabels = "show")
sm
# Matriz de correlacion entre variables numericas
sm <- ggpairs(datos, columns = c(1,4,6,7,8), title = "Correlación entre variables numéricas",
mapping=ggplot2::aes(colour = rating,alpha = 1.4), axisLabels = "show")
sm
ggsave('Output/Images/6correlacionmatriz.png', width = w, height = h)
ggplot(datos,aes(x=rating,y=score, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Score")+
theme_bw()
ggplot(datos,aes(x=rating,y=gross/1000000, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Score")+
theme_bw()
ggplot(datos,aes(x=rating,y=score, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Score de las producciones por Rating")+
theme_bw()
ggplot(datos,aes(x=rating,y=score, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Score")+
ggtitle("Score de las producciones por Rating")+
theme_bw()
datos %>%
ggplot(aes(x = votes/1000)) +
geom_histogram()+
xlab("Votos") + ylab("Número de Votos")
datos %>%
ggplot(aes(x = votes/1000)) +
geom_histogram()+
xlab("Votos") + ylab("Número de Votos")+
ggtitle("Cantidad de votos")
datos %>%
ggplot(aes(x = rating, fill = rating))+
geom_bar()
datos %>%
ggplot(aes(x = rating, fill = rating))+
geom_bar()+ ggtitle("Número de producciones por Rating")
datos %>%
ggplot(aes(x = rating, fill = rating))+
geom_bar()+ ggtitle("Número de producciones por Rating")
ggsave('Output/Images/7produccionesporrating.png', width = w+2, height = h+2)
ggplot(datos,aes(x=rating,y=gross/1000000, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Ganancia (M$)")+
ggtitle("Ganancia de las producciones por Rating")+
theme_bw()
ggsave('Output/Images/8gananciaporrating.png', width = w+2, height = h+2)
ggplot(datos,aes(x=rating,y=score, color=rating)) +
geom_boxplot(outlier.shape = NA,show.legend = F) + geom_jitter(width=0.1,alpha=1,show.legend = F)+
labs(x="Rating", y = "Score")+
ggtitle("Score de las producciones por Rating")+
theme_bw()
ggsave('Output/Images/9scoreporrating.png', width = w+2, height = h+2)
datos %>%
ggplot(aes(x = votes/1000)) +
geom_histogram()+
xlab("Votos") + ylab("Número de Votos")+
ggtitle("Cantidad de votos")
